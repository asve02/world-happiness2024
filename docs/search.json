[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "World Happiness Analysis",
    "section": "",
    "text": "World Happiness Analysis (Kaggle Dataset)\nWelcome to this Quarto website exploring the World Happiness dataset using R and the tidyverse.\nYou can view the full analysis here:\n\nHappiness analysis"
  },
  {
    "objectID": "analysis/happiness-analysis.html",
    "href": "analysis/happiness-analysis.html",
    "title": "World Happiness Analysis-Kaggle dataset",
    "section": "",
    "text": "Show code\n#List of required packages\n\npackages &lt;- c(\"tidyverse\", \"readxl\", \"janitor\", \"broom\", \"plotly\", \"countrycode\", \"tidyr\")\n\n#Install missing packages\n\nfor (pkg in packages) {\nif (!require(pkg, character.only = TRUE)) {\ninstall.packages(pkg)\n}\n}\n\n#Load all packages\n\nlapply(packages, library, character.only = TRUE)\n\n\n[[1]]\n [1] \"countrycode\" \"plotly\"      \"broom\"       \"janitor\"     \"readxl\"     \n [6] \"lubridate\"   \"forcats\"     \"stringr\"     \"dplyr\"       \"purrr\"      \n[11] \"readr\"       \"tidyr\"       \"tibble\"      \"ggplot2\"     \"tidyverse\"  \n[16] \"stats\"       \"graphics\"    \"grDevices\"   \"utils\"       \"datasets\"   \n[21] \"methods\"     \"base\"       \n\n[[2]]\n [1] \"countrycode\" \"plotly\"      \"broom\"       \"janitor\"     \"readxl\"     \n [6] \"lubridate\"   \"forcats\"     \"stringr\"     \"dplyr\"       \"purrr\"      \n[11] \"readr\"       \"tidyr\"       \"tibble\"      \"ggplot2\"     \"tidyverse\"  \n[16] \"stats\"       \"graphics\"    \"grDevices\"   \"utils\"       \"datasets\"   \n[21] \"methods\"     \"base\"       \n\n[[3]]\n [1] \"countrycode\" \"plotly\"      \"broom\"       \"janitor\"     \"readxl\"     \n [6] \"lubridate\"   \"forcats\"     \"stringr\"     \"dplyr\"       \"purrr\"      \n[11] \"readr\"       \"tidyr\"       \"tibble\"      \"ggplot2\"     \"tidyverse\"  \n[16] \"stats\"       \"graphics\"    \"grDevices\"   \"utils\"       \"datasets\"   \n[21] \"methods\"     \"base\"       \n\n[[4]]\n [1] \"countrycode\" \"plotly\"      \"broom\"       \"janitor\"     \"readxl\"     \n [6] \"lubridate\"   \"forcats\"     \"stringr\"     \"dplyr\"       \"purrr\"      \n[11] \"readr\"       \"tidyr\"       \"tibble\"      \"ggplot2\"     \"tidyverse\"  \n[16] \"stats\"       \"graphics\"    \"grDevices\"   \"utils\"       \"datasets\"   \n[21] \"methods\"     \"base\"       \n\n[[5]]\n [1] \"countrycode\" \"plotly\"      \"broom\"       \"janitor\"     \"readxl\"     \n [6] \"lubridate\"   \"forcats\"     \"stringr\"     \"dplyr\"       \"purrr\"      \n[11] \"readr\"       \"tidyr\"       \"tibble\"      \"ggplot2\"     \"tidyverse\"  \n[16] \"stats\"       \"graphics\"    \"grDevices\"   \"utils\"       \"datasets\"   \n[21] \"methods\"     \"base\"       \n\n[[6]]\n [1] \"countrycode\" \"plotly\"      \"broom\"       \"janitor\"     \"readxl\"     \n [6] \"lubridate\"   \"forcats\"     \"stringr\"     \"dplyr\"       \"purrr\"      \n[11] \"readr\"       \"tidyr\"       \"tibble\"      \"ggplot2\"     \"tidyverse\"  \n[16] \"stats\"       \"graphics\"    \"grDevices\"   \"utils\"       \"datasets\"   \n[21] \"methods\"     \"base\"       \n\n[[7]]\n [1] \"countrycode\" \"plotly\"      \"broom\"       \"janitor\"     \"readxl\"     \n [6] \"lubridate\"   \"forcats\"     \"stringr\"     \"dplyr\"       \"purrr\"      \n[11] \"readr\"       \"tidyr\"       \"tibble\"      \"ggplot2\"     \"tidyverse\"  \n[16] \"stats\"       \"graphics\"    \"grDevices\"   \"utils\"       \"datasets\"   \n[21] \"methods\"     \"base\"       \n\n\n\n\nShow code\n#Q1:Read happiness dataset (use \"Alt + -\" for &lt;-)\n\nhappiness &lt;- read_excel(\"../data/happiness.xlsx\")\n\n#Quick look at the data\n\nglimpse(happiness)\n\n\nRows: 2,363\nColumns: 11\n$ `Country name`                     &lt;chr&gt; \"Afghanistan\", \"Afghanistan\", \"Afgh…\n$ year                               &lt;dbl&gt; 2008, 2009, 2010, 2011, 2012, 2013,…\n$ `Life Ladder`                      &lt;dbl&gt; 3.724, 4.402, 4.758, 3.832, 3.783, …\n$ `Log GDP per capita`               &lt;dbl&gt; 7.350, 7.509, 7.614, 7.581, 7.661, …\n$ `Social support`                   &lt;dbl&gt; 0.451, 0.552, 0.539, 0.521, 0.521, …\n$ `Healthy life expectancy at birth` &lt;dbl&gt; 50.500, 50.800, 51.100, 51.400, 51.…\n$ `Freedom to make life choices`     &lt;dbl&gt; 0.718, 0.679, 0.600, 0.496, 0.531, …\n$ Generosity                         &lt;dbl&gt; 0.164, 0.187, 0.118, 0.160, 0.234, …\n$ `Perceptions of corruption`        &lt;dbl&gt; 0.882, 0.850, 0.707, 0.731, 0.776, …\n$ `Positive affect`                  &lt;dbl&gt; 0.414, 0.481, 0.517, 0.480, 0.614, …\n$ `Negative affect`                  &lt;dbl&gt; 0.258, 0.237, 0.275, 0.267, 0.268, …\n\n\nShow code\ncolnames(happiness)\n\n\n [1] \"Country name\"                     \"year\"                            \n [3] \"Life Ladder\"                      \"Log GDP per capita\"              \n [5] \"Social support\"                   \"Healthy life expectancy at birth\"\n [7] \"Freedom to make life choices\"     \"Generosity\"                      \n [9] \"Perceptions of corruption\"        \"Positive affect\"                 \n[11] \"Negative affect\"                 \n\n\n\n\nShow code\n#we see that each column names appear with space between them, lets put \"_\" in place of space \n\nhappiness &lt;- read_excel(\"../data/happiness.xlsx\") |&gt;\n  clean_names() # converts all column names into tidy, R-friendly names\n\n#check if the column names got cleaned (check structure using glimpse)\nglimpse(happiness)\n\n\nRows: 2,363\nColumns: 11\n$ country_name                     &lt;chr&gt; \"Afghanistan\", \"Afghanistan\", \"Afghan…\n$ year                             &lt;dbl&gt; 2008, 2009, 2010, 2011, 2012, 2013, 2…\n$ life_ladder                      &lt;dbl&gt; 3.724, 4.402, 4.758, 3.832, 3.783, 3.…\n$ log_gdp_per_capita               &lt;dbl&gt; 7.350, 7.509, 7.614, 7.581, 7.661, 7.…\n$ social_support                   &lt;dbl&gt; 0.451, 0.552, 0.539, 0.521, 0.521, 0.…\n$ healthy_life_expectancy_at_birth &lt;dbl&gt; 50.500, 50.800, 51.100, 51.400, 51.70…\n$ freedom_to_make_life_choices     &lt;dbl&gt; 0.718, 0.679, 0.600, 0.496, 0.531, 0.…\n$ generosity                       &lt;dbl&gt; 0.164, 0.187, 0.118, 0.160, 0.234, 0.…\n$ perceptions_of_corruption        &lt;dbl&gt; 0.882, 0.850, 0.707, 0.731, 0.776, 0.…\n$ positive_affect                  &lt;dbl&gt; 0.414, 0.481, 0.517, 0.480, 0.614, 0.…\n$ negative_affect                  &lt;dbl&gt; 0.258, 0.237, 0.275, 0.267, 0.268, 0.…\n\n\nShow code\ncolnames(happiness)\n\n\n [1] \"country_name\"                     \"year\"                            \n [3] \"life_ladder\"                      \"log_gdp_per_capita\"              \n [5] \"social_support\"                   \"healthy_life_expectancy_at_birth\"\n [7] \"freedom_to_make_life_choices\"     \"generosity\"                      \n [9] \"perceptions_of_corruption\"        \"positive_affect\"                 \n[11] \"negative_affect\"                 \n\n\n\n\nShow code\n#Q2: Which countries and years included in the dataset?\n#Q2.1: Unique list of countries\nhappiness |&gt;\n  distinct(country_name) |&gt; #distinct() finds unique values\n  arrange(country_name) #arrange() sorts alphabetically\n\n\n# A tibble: 165 × 1\n   country_name\n   &lt;chr&gt;       \n 1 Afghanistan \n 2 Albania     \n 3 Algeria     \n 4 Angola      \n 5 Argentina   \n 6 Armenia     \n 7 Australia   \n 8 Austria     \n 9 Azerbaijan  \n10 Bahrain     \n# ℹ 155 more rows\n\n\nShow code\n#Q2.2: Unique list of years\nhappiness |&gt;\n  distinct(year) |&gt; #distinct() finds unique values\n  arrange(year)\n\n\n# A tibble: 19 × 1\n    year\n   &lt;dbl&gt;\n 1  2005\n 2  2006\n 3  2007\n 4  2008\n 5  2009\n 6  2010\n 7  2011\n 8  2012\n 9  2013\n10  2014\n11  2015\n12  2016\n13  2017\n14  2018\n15  2019\n16  2020\n17  2021\n18  2022\n19  2023\n\n\n\n\nShow code\n#Q3: How many years of data does each country have?\nhappiness |&gt;\n  count(country_name, sort = TRUE) #sort used to sort result in descending order\n\n\n# A tibble: 165 × 2\n   country_name     n\n   &lt;chr&gt;        &lt;int&gt;\n 1 Argentina       18\n 2 Bangladesh      18\n 3 Bolivia         18\n 4 Brazil          18\n 5 Cambodia        18\n 6 Cameroon        18\n 7 Canada          18\n 8 Chile           18\n 9 Colombia        18\n10 Costa Rica      18\n# ℹ 155 more rows\n\n\n\n\nShow code\n#Q4: What is the average Life Ladder (happiness score) for each year?\nhappiness |&gt;\n  group_by(year) |&gt;\n  summarise(\n    mean_happiness = mean(life_ladder, na.rm = TRUE),\n    n_countries = n()\n    ) |&gt;\n  arrange(year)\n\n\n# A tibble: 19 × 3\n    year mean_happiness n_countries\n   &lt;dbl&gt;          &lt;dbl&gt;       &lt;int&gt;\n 1  2005           6.45          27\n 2  2006           5.20          89\n 3  2007           5.42         102\n 4  2008           5.42         110\n 5  2009           5.46         114\n 6  2010           5.50         124\n 7  2011           5.42         146\n 8  2012           5.44         141\n 9  2013           5.39         136\n10  2014           5.39         144\n11  2015           5.40         142\n12  2016           5.40         141\n13  2017           5.46         147\n14  2018           5.50         141\n15  2019           5.57         143\n16  2020           5.73         116\n17  2021           5.64         122\n18  2022           5.50         140\n19  2023           5.62         138\n\n\nShow code\n#summarise(): calculates summary values inside each group\n#na.rm = TRUE: \n\n\n\n\nShow code\n#Q5: Classify life Ladder scores into High, Medium, and Low groups based on quartiles and add this as a new column\n#Step 1 — Create ladder_group using ntile()\nhappiness_grouped &lt;- happiness |&gt;\n  mutate(\n    ladder_group = case_when( # case_when() lets us assign a category based on conditions\n      ntile(life_ladder, 4) == 4 ~ \"High\", # divides the numeric variable into 4 equal sized groups (quartiles)\n      ntile(life_ladder, 4) %in% c(2, 3) ~ \"Medium\", # Q1: bottom 25%; Q2-3: Middle 50%; Q4: Top 25%\n      ntile(life_ladder, 4) == 1 ~ \"Low\"\n    )\n  )\n#After case_when(), the column is a character vector: e.g., \"High\"\n#also, Character vectors are alphabetically ordered when plotted or summarized: High, Low, Medium- this is not the logical order of happiness\n\n# Step 2: Optional ordered factor \nhappiness_grouped &lt;- happiness_grouped |&gt;\n  mutate(\n    ladder_group = factor(ladder_group, #A factor is a categorical variable with controlled order\n                          levels = c(\"Low\", \"Medium\", \"High\"))\n  )\nhappiness_grouped\n\n\n# A tibble: 2,363 × 12\n   country_name  year life_ladder log_gdp_per_capita social_support\n   &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;              &lt;dbl&gt;          &lt;dbl&gt;\n 1 Afghanistan   2008        3.72               7.35          0.451\n 2 Afghanistan   2009        4.40               7.51          0.552\n 3 Afghanistan   2010        4.76               7.61          0.539\n 4 Afghanistan   2011        3.83               7.58          0.521\n 5 Afghanistan   2012        3.78               7.66          0.521\n 6 Afghanistan   2013        3.57               7.68          0.484\n 7 Afghanistan   2014        3.13               7.67          0.526\n 8 Afghanistan   2015        3.98               7.65          0.529\n 9 Afghanistan   2016        4.22               7.65          0.559\n10 Afghanistan   2017        2.66               7.65          0.491\n# ℹ 2,353 more rows\n# ℹ 7 more variables: healthy_life_expectancy_at_birth &lt;dbl&gt;,\n#   freedom_to_make_life_choices &lt;dbl&gt;, generosity &lt;dbl&gt;,\n#   perceptions_of_corruption &lt;dbl&gt;, positive_affect &lt;dbl&gt;,\n#   negative_affect &lt;dbl&gt;, ladder_group &lt;fct&gt;\n\n\n\n\nShow code\n#Q5: List all countries where Happiness Score is above the global mean\n#Step1: Calculate global mean happiness score\nglobal_mean_happiness &lt;- happiness |&gt;\n  summarise(global_mean = mean(life_ladder, na.rm = TRUE)) |&gt; # returns a tibble with one row and one column, not a numeric value\n  pull(global_mean) # extracts the value and turn into a pure numeric vector\nglobal_mean_happiness\n\n\n[1] 5.483566\n\n\nShow code\n#Step2: filter countries avove this mean\nabove_mean &lt;- happiness |&gt;\n  filter(life_ladder &gt; global_mean_happiness) |&gt;\n  arrange(desc(life_ladder))\n\nabove_mean\n\n\n# A tibble: 1,153 × 11\n   country_name  year life_ladder log_gdp_per_capita social_support\n   &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;              &lt;dbl&gt;          &lt;dbl&gt;\n 1 Denmark       2005        8.02               10.8          0.972\n 2 Denmark       2008        7.97               10.9          0.954\n 3 Finland       2020        7.89               10.8          0.962\n 4 Finland       2018        7.86               10.8          0.962\n 5 Denmark       2007        7.83               10.9          0.954\n 6 Finland       2021        7.79               10.8          0.97 \n 7 Denmark       2011        7.79               10.8          0.962\n 8 Finland       2017        7.79               10.8          0.964\n 9 Finland       2019        7.78               10.8          0.937\n10 Switzerland   2012        7.78               11.1          0.947\n# ℹ 1,143 more rows\n# ℹ 6 more variables: healthy_life_expectancy_at_birth &lt;dbl&gt;,\n#   freedom_to_make_life_choices &lt;dbl&gt;, generosity &lt;dbl&gt;,\n#   perceptions_of_corruption &lt;dbl&gt;, positive_affect &lt;dbl&gt;,\n#   negative_affect &lt;dbl&gt;\n\n\n\n\nShow code\ncolnames(happiness)\n\n\n [1] \"country_name\"                     \"year\"                            \n [3] \"life_ladder\"                      \"log_gdp_per_capita\"              \n [5] \"social_support\"                   \"healthy_life_expectancy_at_birth\"\n [7] \"freedom_to_make_life_choices\"     \"generosity\"                      \n [9] \"perceptions_of_corruption\"        \"positive_affect\"                 \n[11] \"negative_affect\"                 \n\n\n\n\nShow code\n#Q6: Correlation of life_ladder with all variables\n#select numeric variable only\nnumeric_data &lt;- happiness |&gt;\n  select(where(is.numeric))\n\n\n\n\nShow code\n#Compute correlation of each numeric variable with life_ladder\nlife_cor &lt;- numeric_data |&gt;\n  summarise(\n    across(\n      .cols = everything(),\n      .fns = ~ cor(.x, life_ladder, use = \"complete.obs\")\n    )\n  )\n\n#Pivot longer and remove the self-correlation (1.0)\nlife_cor_long &lt;- life_cor |&gt;\n  tidyr::pivot_longer(\n    cols = everything(),\n    names_to = \"variable\",\n    values_to = \"correlation\"\n  ) |&gt;\n  filter(variable != \"life_ladder\")\n#heatmap\n\nggplot(life_cor_long, aes(x = variable, y = \"life_ladder\", fill = correlation)) +\n  geom_tile(color = \"white\") +\n  geom_text(aes(label = round(correlation, 2)), color = \"black\") +\n  scale_fill_gradient2(\n    low = \"red\",\n    high = \"blue\",\n    mid = \"white\",\n    midpoint = 0,\n    limits = c(-1, 1)\n  ) +\n  labs(\n    title = \"Correlation of Life Ladder with All Numeric Variables\",\n    x = \"Variable\",\n    y = \"\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 35, hjust = 1)\n  )\n\n\n\n\n\n\n\n\n\nShow code\n#heatmap does not look good, so a barplot plotted\nggplot(life_cor_long, aes(x = reorder(variable, correlation), y = correlation)) +\n  geom_col(fill = \"steelblue\") +\n  coord_flip() +\n  geom_text(aes(label = round(correlation, 2)),\n            hjust = -0.1, size = 4) +\n  labs(\n    title = \"Correlation of Life Ladder with All Numeric Variables\",\n    x = \"Variable\",\n    y = \"Correlation\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\nShow code\n#Q7: What is the global happiness trend over time? (Line plot)\n#To answer that, for each year we need one number: the mean Life Ladder across all countries that have data in that year.\n\n#Calculate global mean happiness per year\nhappiness_yearly &lt;- happiness |&gt;\ngroup_by(year) |&gt;\nsummarise(\nmean_happiness = mean(life_ladder, na.rm = TRUE)\n)\n\n\n\n\nShow code\n#plot\nhappiness_yearly |&gt;\nggplot(aes(x = year, y = mean_happiness)) +\ngeom_line(linewidth = 1.2) +\ngeom_point(size = 2) +\nlabs(\ntitle = \"Global Happiness Trend Over Time\",\nx = \"Year\",\ny = \"Average Life Ladder (Happiness Score)\"\n)+\n  theme_bw()\n\n\n\n\n\n\n\n\n\n\n\nShow code\n#Q8: Which countries are the happiest on average across all years?\ncountry_means &lt;- happiness |&gt;\n  group_by(country_name) |&gt;\n  summarise(\n    mean_happiness = mean(life_ladder, na.rm = TRUE),\n    n_years = n()\n  ) |&gt;\n  arrange(desc(mean_happiness))\n\n#show top 10 happinest counntries\nhead(country_means, 10)\n\n\n# A tibble: 10 × 3\n   country_name mean_happiness n_years\n   &lt;chr&gt;                 &lt;dbl&gt;   &lt;int&gt;\n 1 Denmark                7.66      18\n 2 Finland                7.62      16\n 3 Iceland                7.47      11\n 4 Norway                 7.46      13\n 5 Netherlands            7.44      17\n 6 Switzerland            7.44      13\n 7 Sweden                 7.37      18\n 8 Canada                 7.30      18\n 9 New Zealand            7.26      17\n10 Australia              7.24      17\n\n\n\n\nShow code\n#Q8.1: A bar plot of top 10 happiest countries?\ntop10_countries &lt;- country_means |&gt;\n  slice_head(n = 10)\n\n#Plot bar chart of top 10 happiest countries\ntop10_countries |&gt;\nggplot(aes(x = reorder(country_name, mean_happiness), \ny = mean_happiness)) +\ngeom_col() +\n  coord_flip()+\nlabs(\ntitle = \"Top 10 Happiest Countries (Average Life Ladder)\",\nx = \"Country\",\ny = \"Average Happiness Score\"\n)\n\n\n\n\n\n\n\n\n\nShow code\n#aes(x = reorder(country_name, mean_happiness), y = mean_happiness)\n#reorder(x, y) tells R: “Sort x according to y.”\n#“Take country_name and reorder it based on the values of mean_happiness.”\n#Because in a bar plot: The height of the bar is determined by y\n#The position/order of the bars is determined by x\n#So sorting must be applied to x, not y.\n#geom_col(): draw bars where height = y value.This is used when you already have a summary value (like mean), not raw counts.\n#coord_flip(): swaps x and y axes: countries go on the vertical axis\n#bars extend horizontally. This is much easier to read when we have long country names.\n\n\n\n\nShow code\n#Q8.2: A barplot of bottom 10 countries\nbottom_10_countries &lt;- country_means |&gt;\n  slice_tail(n = 10)\n#plot barchart of bottom 10 countries\nbottom_10_countries |&gt;\n  ggplot(aes(x = reorder(country_name, mean_happiness),\n             y = mean_happiness))+\n  geom_col()+\n  coord_flip()+\n  labs(\n    title = \"Bottom 10 happiest countries (Average Life Ladder)\",\n    x = \"Country\",\n    y = \"Average Happiness Score\"\n  )\n\n\n\n\n\n\n\n\n\n\n\nShow code\n#Q9: How does GDP relate to happiness?\n#(Happiness = Life Ladder, GDP = Log GDP per capita)\n\n#Step 1: Prepare data (remove missing values)\n\ngdp_data &lt;- happiness |&gt;\ndrop_na(life_ladder, log_gdp_per_capita) \n\n#drop_na() ensures that only rows with complete values are kept\n\n#Step 2: Scatter plot of GDP vs Happiness\n\ngdp_data |&gt;\nggplot(aes(x = log_gdp_per_capita, y = life_ladder)) +\ngeom_point(alpha = 0.4) + #alpha = 0.4 makes points semi-transparent so dense areas become visible\ngeom_smooth(method = \"lm\", se = TRUE) +\nlabs(\ntitle = \"Relationship Between GDP and Happiness\",\nx = \"Log GDP per capita\",\ny = \"Life Ladder (Happiness Score)\"\n)\n\n\n\n\n\n\n\n\n\nShow code\n#method = \"lm\" fits a straight line (linear model)\n#se = TRUE adds a shaded confidence interval → uncertainty around the line\n\n\n\n\nShow code\n#Q9.1: lets try to mention the linear regression equation on the plot\n\n#Step 1: Clean data\n\ngdp_data &lt;- happiness |&gt;\ndrop_na(life_ladder, log_gdp_per_capita)\n\n#Step 2: Fit linear model (Happiness = Intercept + Slope × LogGDP)\n#even if one is missing, that row can't be used\n\nmodel &lt;- lm(life_ladder ~  log_gdp_per_capita, data = gdp_data)\n\n#Step 3: Extract coefficients and R²\nmodel_stats &lt;- tidy(model) #this returns a table of statistics of regression table (row1 = intercept (constant term); row2: slope (coefficient of log GDP))\nmodel_glance &lt;- glance(model) #extract  R2\n\n#store these statistics value\nintercept &lt;- round(model_stats$estimate[1], 2) #till 2 decimenl places\nslope &lt;- round(model_stats$estimate[2], 2)\nr2 &lt;- round(model_glance$r.squared, 2)\n\n#build equation text\neq_text &lt;- paste0( \n\"Happiness = \", intercept, \" + \", slope, \" × logGDP\\n\",\n\"R² = \", r2\n)\n\n#paste0(): It concatenates strings without spaces unless we add them manually.\n#Step 4: Plot with regression line + equation\n\ngdp_data |&gt;\nggplot(aes(log_gdp_per_capita, life_ladder)) +\ngeom_point(alpha = 0.4) +\ngeom_smooth(method = \"lm\", se = TRUE) +\nannotate(\n\"text\", #We want to draw text, not shapes or lines.\nx = max(gdp_data$log_gdp_per_capita) * 0.6, #Place the equation 60% across the x-axis (right side but not too far).\ny = max(gdp_data$life_ladder) * 0.95, #Place it 95% up the y-axis (near the top)\nlabel = eq_text, #This is the formatted equation + R²\nhjust = 0, #Left-align the text (so it doesn’t look squeezed).\nsize = 4\n) +\nlabs(\ntitle = \"GDP vs Happiness with Regression Equation\",\nx = \"Log GDP per capita\",\ny = \"Life Ladder (Happiness Score)\"\n)\n\n\n\n\n\n\n\n\n\n\n\nShow code\n# Q10: Plot a worl map and show how happiness score changes over time -interactive plot\n#Prepare data for mapping\nhappiness_map &lt;- happiness |&gt;\n  mutate( \n    iso3 = countrycode(country_name, \"country.name\", \"iso3c\")\n  ) |&gt;\n  drop_na(iso3, life_ladder) #remove rows where iso3 code and life_ladder missing\n\n# Build interactive world map with year slider\nfig &lt;- happiness_map |&gt;\n  plot_ly(  #plotly interactive plot\n    locations = ~iso3, #Draw a country based on its ISO3 code\n    z = ~life_ladder, #This determines the color shading of each country.\n    frame = ~year, #created the year slider, one map per year\n    type = \"choropleth\", #A choropleth map meanswhere each country is shaded based on the value of a variable\n    color = ~life_ladder, #Use Life Ladder values to determine the map color.\n    colorscale = \"Viridis\" #color-blind friendly\n  ) |&gt;\n  colorbar(title = \"Life Ladder\") |&gt; #Adds a legend on the right showing the mapping between color and happiness score.\n  layout( #Controls the visual layout\n    title = \"World Happiness Over Time\",\n    geo = list(showframe = FALSE, showcoastlines = FALSE)) #no border frames and coastlines\n\nfig\n\n\n\n\n\n\nShow code\n##We take the original happiness dataset and add a new column called iso3\n#Plotly requires ISO3 codes in the locations argument."
  }
]